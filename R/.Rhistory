install.packages('XML')
## 서비스업
rawData_SVC <- readxl::read_excel("../data/MDIS/서비스업.xlsx", sheet = "데이터", col_names = T, skip = 0)
setwd("C:/Users/DESKTOP/Desktop/TNFD/R")
## 서비스업
rawData_SVC <- readxl::read_excel("../data/MDIS/서비스업.xlsx", sheet = "데이터", col_names = T, skip = 0)
rawData_SVC
View(rawData_SVC)
## 광업_제조업
rawData_MiMa <- readxl::read_excel("../data/MDIS/광업_제조업.xlsx", sheet = "데이터", col_names = T, skip = 0)
## 광업_제조업
rawData_MiMa <- readxl::read_excel("../data/MDIS/광업_제조업.xlsx", sheet = "데이터", col_names = T, skip = 0)
rawData_MiMa
rawData_Se <- rawData_Se %>%
rename(시도코드 = 행정구역시도코드,
대분류코드 = 산업대분류코드,
중분류코드 = 주사업_산업중분류코드,
소분류코드 = 주사업_산업소분류코드,
세분류코드 = 주사업_산업세분류코드,
세세분류코드 = 주사업_산업세세분류코드
)
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)
library(openxlsx)
library(tidyverse)
rawData_Se <- rawData_Se %>%
rename(시도코드 = 행정구역시도코드,
대분류코드 = 산업대분류코드,
중분류코드 = 주사업_산업중분류코드,
소분류코드 = 주사업_산업소분류코드,
세분류코드 = 주사업_산업세분류코드,
세세분류코드 = 주사업_산업세세분류코드
)
## 서비스업
rawData_Se <- readxl::read_excel("../data/MDIS/서비스업.xlsx", sheet = "데이터", col_names = T, skip = 0)
rawData_Se <- rawData_Se %>%
rename(시도코드 = 행정구역시도코드,
대분류코드 = 산업대분류코드,
중분류코드 = 주사업_산업중분류코드,
소분류코드 = 주사업_산업소분류코드,
세분류코드 = 주사업_산업세분류코드,
세세분류코드 = 주사업_산업세세분류코드
)
rawData_Se <- rawData_Se %>%
rename(시도코드 = 행정구역코드,
대분류코드 = 산업대분류코드,
중분류코드 = 주사업_산업중분류코드,
소분류코드 = 주사업_산업소분류코드,
세분류코드 = 주사업_산업세분류코드,
세세분류코드 = 주사업_산업세세분류코드
)
rawData_MiMa <- rawData_MiMa %>%
rename(시도코드 = 행정구역시도코드,
대분류코드 = 산업대분류코드,
중분류코드 = 주사업_산업중분류코드,
소분류코드 = 주사업_산업소분류코드,
세분류코드 = 주사업_산업세분류코드,
세세분류코드 = 주사업_산업세세분류코드
)
rawData_MiMa
## 운수업
rawData_Tr <- readxl::read_excel("../data/MDIS/광업_제조업.xlsx", sheet = "데이터", col_names = T, skip = 0)
rawData_Tr
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)
library(openxlsx)
library(tidyverse)
## 서비스업
rawData_Se <- readxl::read_excel("../data/MDIS/서비스업.xlsx", sheet = "데이터", col_names = T, skip = 0)
rawData_Se <- rawData_Se %>%
rename(시도코드 = 행정구역코드,
대분류코드 = 산업대분류코드,
중분류코드 = 산업중분류코드,
소분류코드 = 산업소분류코드,
세분류코드 = 산업세분류코드,
세세분류코드 = 산업세세분류코드,
종사자수 = 종사자수_합계수
) %>%
select(시도코드, 대분류코드, 중분류코드, 소분류코드, 세분류코드, 세세분류코드,
종사자수, 매출액)
## 운수업
rawData_Tr <- readxl::read_excel("../data/MDIS/광업_제조업.xlsx", sheet = "데이터", col_names = T, skip = 0)
rawData_Tr <- rawData_Tr %>%
rename(시도코드 = 행정구역코드,
대분류코드 = 산업대분류코드,
중분류코드 = 산업중분류코드,
소분류코드 = 산업소분류코드,
세분류코드 = 산업세분류코드,
세세분류코드 = 산업세세분류코드,
종사자수 = 종사자수_조사_총소계,
매출액 = 매출총액
) %>%
select(시도코드, 대분류코드, 중분류코드, 소분류코드, 세분류코드, 세세분류코드,
종사자수, 매출액, 자본금)
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)
library(openxlsx)
library(tidyverse)
## 서비스업
rawData_Se <- readxl::read_excel("../data/MDIS/서비스업.xlsx", sheet = "데이터", col_names = T, skip = 0)
rawData_Se <- rawData_Se %>%
rename(시도코드 = 행정구역코드,
대분류코드 = 산업대분류코드,
중분류코드 = 산업중분류코드,
소분류코드 = 산업소분류코드,
세분류코드 = 산업세분류코드,
세세분류코드 = 산업세세분류코드,
종사자수 = 종사자수_합계수
) %>%
select(시도코드, 대분류코드, 중분류코드, 소분류코드, 세분류코드, 세세분류코드,
종사자수, 매출액)
## 운수업
rawData_Tr <- readxl::read_excel("../data/MDIS/운수업.xlsx", sheet = "데이터", col_names = T, skip = 0)
rawData_Tr <- rawData_Tr %>%
rename(시도코드 = 행정구역코드,
대분류코드 = 산업대분류코드,
중분류코드 = 산업중분류코드,
소분류코드 = 산업소분류코드,
세분류코드 = 산업세분류코드,
세세분류코드 = 산업세세분류코드,
종사자수 = 종사자수_조사_총소계,
매출액 = 매출총액
) %>%
select(시도코드, 대분류코드, 중분류코드, 소분류코드, 세분류코드, 세세분류코드,
종사자수, 매출액, 자본금)
## 운수업
rawData_Tr <- readxl::read_excel("../data/MDIS/운수업.xlsx", sheet = "데이터", col_names = T, skip = 0)
rawData_Tr <- rawData_Tr %>%
rename(시도코드 = 행정구역시도코드,
대분류코드 = 산업대분류코드,
중분류코드 = 산업중분류코드,
소분류코드 = 산업소분류코드,
세분류코드 = 산업세분류코드,
세세분류코드 = 산업세세분류코드,
종사자수 = 종사자수_조사_총소계,
매출액 = 매출총액
) %>%
select(시도코드, 대분류코드, 중분류코드, 소분류코드, 세분류코드, 세세분류코드,
종사자수, 매출액, 자본금)
## 광업_제조업
rawData_MiMa <- readxl::read_excel("../data/MDIS/광업_제조업.xlsx", sheet = "데이터", col_names = T, skip = 0)
rawData_MiMa <- rawData_MiMa %>%
rename(시도코드 = 행정구역시도코드,
대분류코드 = 산업대분류코드,
중분류코드 = 주사업_산업중분류코드,
소분류코드 = 주사업_산업소분류코드,
세분류코드 = 주사업_산업세분류코드,
세세분류코드 = 주사업_산업세세분류코드,
종사자수 = 종사자수_조사_총소계
) %>%
select(시도코드, 대분류코드, 중분류코드, 소분류코드, 세분류코드, 세세분류코드,
종사자수, 부가가치금액)
rawData_Se
rawData_Tr
rawData_MiMa
## Merge ##
rawData_Se %>% bind_rows(rawData_Tr, rawData_MiMa)
head(rawData_Se)
head(rawData_Tr)
head(rawData_MiMa)
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)
library(openxlsx)
library(tidyverse)
## 서비스업
rawData_Se <- readxl::read_excel("../data/MDIS/서비스업.xlsx", sheet = "데이터", col_names = T, skip = 0)
rawData_Se <- rawData_Se %>%
rename(시도코드 = 행정구역코드,
대분류코드 = 산업대분류코드,
중분류코드 = 산업중분류코드,
소분류코드 = 산업소분류코드,
세분류코드 = 산업세분류코드,
세세분류코드 = 산업세세분류코드,
종사자수 = 종사자수_합계수
) %>%
mutate(종사자수 = as.numeric(종사자수)) %>%
select(시도코드, 대분류코드, 중분류코드, 소분류코드, 세분류코드, 세세분류코드,
종사자수, 매출액)
## 운수업
rawData_Tr <- readxl::read_excel("../data/MDIS/운수업.xlsx", sheet = "데이터", col_names = T, skip = 0)
rawData_Tr <- rawData_Tr %>%
rename(시도코드 = 행정구역시도코드,
대분류코드 = 산업대분류코드,
중분류코드 = 산업중분류코드,
소분류코드 = 산업소분류코드,
세분류코드 = 산업세분류코드,
세세분류코드 = 산업세세분류코드,
종사자수 = 종사자수_조사_총소계,
매출액 = 매출총액
) %>%
mutate(종사자수 = as.numeric(종사자수)) %>%
select(시도코드, 대분류코드, 중분류코드, 소분류코드, 세분류코드, 세세분류코드,
종사자수, 매출액, 자본금)
## 광업_제조업
rawData_MiMa <- readxl::read_excel("../data/MDIS/광업_제조업.xlsx", sheet = "데이터", col_names = T, skip = 0)
rawData_MiMa <- rawData_MiMa %>%
rename(시도코드 = 행정구역시도코드,
대분류코드 = 산업대분류코드,
중분류코드 = 주사업_산업중분류코드,
소분류코드 = 주사업_산업소분류코드,
세분류코드 = 주사업_산업세분류코드,
세세분류코드 = 주사업_산업세세분류코드,
종사자수 = 종사자수_조사_총소계
) %>%
mutate(종사자수 = as.numeric(종사자수)) %>%
select(시도코드, 대분류코드, 중분류코드, 소분류코드, 세분류코드, 세세분류코드,
종사자수, 부가가치금액)
## Merge ##
rawData_Se %>% bind_rows(rawData_Tr, rawData_MiMa)
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)
library(openxlsx)
library(tidyverse)
## 서비스업
rawData_Se <- readxl::read_excel("../data/MDIS/서비스업.xlsx", sheet = "데이터", col_names = T, skip = 0)
rawData_Se <- rawData_Se %>%
rename(시도코드 = 행정구역코드,
대분류코드 = 산업대분류코드,
중분류코드 = 산업중분류코드,
소분류코드 = 산업소분류코드,
세분류코드 = 산업세분류코드,
세세분류코드 = 산업세세분류코드,
종사자수 = 종사자수_합계수
) %>%
mutate(종사자수 = as.numeric(종사자수),
매출액 = as.numeric(매출액)) %>%
select(시도코드, 대분류코드, 중분류코드, 소분류코드, 세분류코드, 세세분류코드,
종사자수, 매출액)
## 운수업
rawData_Tr <- readxl::read_excel("../data/MDIS/운수업.xlsx", sheet = "데이터", col_names = T, skip = 0)
rawData_Tr <- rawData_Tr %>%
rename(시도코드 = 행정구역시도코드,
대분류코드 = 산업대분류코드,
중분류코드 = 산업중분류코드,
소분류코드 = 산업소분류코드,
세분류코드 = 산업세분류코드,
세세분류코드 = 산업세세분류코드,
종사자수 = 종사자수_조사_총소계,
매출액 = 매출총액
) %>%
mutate(종사자수 = as.numeric(종사자수),
매출액 = as.numeric(매출액)) %>%
select(시도코드, 대분류코드, 중분류코드, 소분류코드, 세분류코드, 세세분류코드,
종사자수, 매출액, 자본금)
## 광업_제조업
rawData_MiMa <- readxl::read_excel("../data/MDIS/광업_제조업.xlsx", sheet = "데이터", col_names = T, skip = 0)
rawData_MiMa <- rawData_MiMa %>%
rename(시도코드 = 행정구역시도코드,
대분류코드 = 산업대분류코드,
중분류코드 = 주사업_산업중분류코드,
소분류코드 = 주사업_산업소분류코드,
세분류코드 = 주사업_산업세분류코드,
세세분류코드 = 주사업_산업세세분류코드,
종사자수 = 종사자수_조사_총소계
) %>%
mutate(종사자수 = as.numeric(종사자수)) %>%
select(시도코드, 대분류코드, 중분류코드, 소분류코드, 세분류코드, 세세분류코드,
종사자수, 부가가치금액)
## Merge ##
rawData_Se %>% bind_rows(rawData_Tr, rawData_MiMa)
## Merge ##
totalData <- rawData_Se %>% bind_rows(rawData_Tr, rawData_MiMa)
totalData %>%
filter(시도코드 == 31)
totalData_GG <- totalData %>%
filter(시도코드 == 31)
unique(totalData_GG$대분류코드)
ggplot(data = totalData_GG, aes(x = 대분류코드)) +
geom_bar(stat = 'bin', width = 0.7)
ggplot(data = totalData_GG, aes(x = 대분류코드)) +
geom_bar(stat = 'count', width = 0.7)
totalData_GG %>%
count(대분류)
totalData_GG %>%
count(대분류코드)
totalData_GG %>%
count(대분류코드, 중분류코드)
totalData_GG
View(totalData_GG)
## Code Mapping ##
CodeMap <- readxl::read_excel("../data/codeMapping.xlsx", sheet = "데이터", col_names = T, skip = 1)
## Code Mapping ##
CodeMap <- readxl::read_excel("../data/codeMapping.xlsx", sheet = "데이터", col_names = T, skip = 1)
CodeMap
totalData_GG
unique(CodeMap$소분류코드)
library(stringr)
str_sub( unique(CodeMap$소분류코드), 2)
?str_sub
str_sub( unique(CodeMap$소분류코드), 2,0)
str_sub( unique(CodeMap$소분류코드), 1)
str_sub( unique(CodeMap$소분류코드), 2)
str_sub( unique(CodeMap$소분류코드), 3)
str_sub( unique(CodeMap$소분류코드), 4)
str_sub( unique(CodeMap$소분류코드), 0)
str_sub( unique(CodeMap$소분류코드), 3)
## Merge ##
totalData <- rawData_Se %>% bind_rows(rawData_Tr, rawData_MiMa)
totalData
CodeMap
## Code Mapping ##
CodeMap <- readxl::read_excel("../data/codeMapping.xlsx", sheet = "데이터", col_names = T, skip = 1) %>%
mutate(소분류코드 = str_sub( 소분류코드 3))
## Code Mapping ##
CodeMap <- readxl::read_excel("../data/codeMapping.xlsx", sheet = "데이터", col_names = T, skip = 1) %>%
mutate(소분류코드 = str_sub( 소분류코드, 3))
CodeMap
View(CodeMap)
## Code Mapping ##
CodeMap <- readxl::read_excel("../data/codeMapping.xlsx", sheet = "데이터", col_names = T, skip = 1) %>%
mutate(소분류코드 = str_sub( 소분류코드, 3),
세분류코드 = str_sub( 세분류코드, 4),
세세분류코드 = str_sub( 세세분류코드, 5))
CodeMap
totalData %>%
left_join(CodeMap, by = c('대분류코드', '중분류코드', '소분류코드', '세분류코드', '세세분류코드'))
totalData
## Code Mapping ##
CodeMap <- readxl::read_excel("../data/codeMapping.xlsx", sheet = "데이터", col_names = T, skip = 1) %>%
mutate(소분류코드 = str_sub( 소분류코드, 3),
세분류코드 = str_sub( 세분류코드, 4),
세세분류코드 = str_sub( 세세분류코드, 5))
## Merge ##
totalData <- rawData_Se %>% bind_rows(rawData_Tr, rawData_MiMa)
totalData %>%
left_join(CodeMap, by = c('대분류코드', '중분류코드', '소분류코드', '세분류코드', '세세분류코드'))
## Code Mapping ##
CodeMap <- readxl::read_excel("../data/codeMapping.xlsx", sheet = "데이터", col_names = T, skip = 1) %>%
mutate(소분류코드 = str_sub( 소분류코드, 3),
세분류코드 = str_sub( 세분류코드, 4),
세세분류코드 = str_sub( 세세분류코드, 5)) %>%
mutate(중분류코드 = as.numeric(중분류코드),
소분류코드 = as.numeric(소분류코드),
세분류코드 = as.numeric(세분류코드),
세세분류코드 = as.numeric(세세분류코드))
## Merge ##
totalData <- rawData_Se %>% bind_rows(rawData_Tr, rawData_MiMa)
totalData %>%
left_join(CodeMap, by = c('대분류코드', '중분류코드', '소분류코드', '세분류코드', '세세분류코드'))
## Merge ##
totalData <- rawData_Se %>% bind_rows(rawData_Tr, rawData_MiMa) %>%
left_join(CodeMap, by = c('대분류코드', '중분류코드', '소분류코드', '세분류코드', '세세분류코드'))
totalData_GG <- totalData %>%
filter(시도코드 == 31)
totalData_GG %>%
count(대분류코드, 중분류코드)
totalData_GG %>%
count(대분류코드, 중분류코드, 대분류명)
totalData_GG %>%
count(대분류코드, 중분류코드, 대분류명, 중분류명)
totalData_GG %>%
count(대분류코드, 중분류코드, 소분류코드, 세분류코드, 세세분류코드,
대분류명, 중분류명, 소분류명, 세분류명, 세세분류명)
View(totalData_GG %>%
count(대분류코드, 중분류코드, 소분류코드, 세분류코드, 세세분류코드,
대분류명, 중분류명, 소분류명, 세분류명, 세세분류명)
)
totalData_GG_Num <- totalData_GG %>%
count(대분류코드, 중분류코드, 소분류코드, 세분류코드, 세세분류코드,
대분류명, 중분류명, 소분류명, 세분류명, 세세분류명)
write.csv(totalData_GG_Num, "totalData_GG_Num.csv")
write.csv(totalData_GG_Num, "totalData_GG_Num.csv", fileEncoding = "EUC-KR")
View(totalData_GG)
setwd("C:/Users/DESKTOP/Desktop/TNFD/R")
## 상장
rawData_KOS <- readxl::read_excel("../data/상장법인/상장법인목록.xlsx", sheet = "데이터", col_names = T, skip = 0)
rawData_KOS
TNFD_Map <- readxl::read_excel("../data/상장법인/TNFD 맵핑.xlsx", sheet = "데이터", col_names = T, skip = 0)
TNFD_Map <- readxl::read_excel("../data/TNFD 맵핑.xlsx", sheet = "데이터", col_names = T, skip = 0)
TNFD_Map
rawData_KOS %>%
left_join(TNFD_Map, by = c("업종"))
View(rawData_KOS %>%
left_join(TNFD_Map, by = c("업종")))
TNFD_Def <- readxl::read_excel("../data/TNFD 맵핑.xlsx", sheet = "TNFD정의", col_names = T, skip = 0)
TNFD_Def''
TNFD_Def
## 상장
rawData_KOS <- readxl::read_excel("../data/상장법인/상장법인목록.xlsx", sheet = "데이터", col_names = T, skip = 0)
TNFD_Map <- readxl::read_excel("../data/TNFD 맵핑.xlsx", sheet = "상장기업toTNFD", col_names = T, skip = 0)
TNFD_Def <- readxl::read_excel("../data/TNFD 맵핑.xlsx", sheet = "TNFD정의", col_names = T, skip = 0)
rawData_KOS %>%
left_join(TNFD_Map, by = c("업종"))
rawData_KOS %>%
left_join(TNFD_Map, by = c("업종"))
## 상장
rawData_KOS <- readxl::read_excel("../data/상장법인/상장법인목록.xlsx", sheet = "데이터", col_names = T, skip = 0)
TNFD_Map <- readxl::read_excel("../data/TNFD 맵핑.xlsx", sheet = "상장기업toTNFD", col_names = T, skip = 0)
TNFD_Def <- readxl::read_excel("../data/TNFD 맵핑.xlsx", sheet = "TNFD정의", col_names = T, skip = 0)
rawData_KOS %>%
left_join(TNFD_Map, by = c("업종"))
TNFD_Def
rawData_KOS %>%
left_join(TNFD_Map, by = c("업종")) %>%
left_join(TNFD_Def, by = c("분류"))
View(rawData_KOS %>%
left_join(TNFD_Map, by = c("업종")) %>%
left_join(TNFD_Def, by = c("분류")))
